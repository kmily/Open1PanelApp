# 工具箱模块开发计划

## 里程碑定义

### M1: 工具箱入口与状态概览 (第1-2周)
- 工具箱统一入口页面
- 各工具状态卡片
- 快速操作入口

### M2: ClamAV病毒扫描 (第3-4周)
- 服务状态管理
- 病毒扫描执行
- 感染文件处理
- 病毒库管理

### M3: FTP与Fail2ban (第5-6周)
- FTP服务管理
- FTP账户管理
- Fail2ban配置
- 封禁IP管理

### M4: 磁盘管理与测试 (第7-8周)
- 磁盘列表展示
- 挂载/卸载操作
- 单元测试覆盖
- 集成测试

## 任务分解

### API层任务
| 任务 | 优先级 | 预估工时 | 依赖 |
|------|--------|----------|------|
| ToolboxClient完善 | P0 | 4h | 无 |
| ClamAV API封装 | P0 | 3h | ToolboxClient |
| FTP API封装 | P1 | 2h | ToolboxClient |
| Fail2ban API封装 | P1 | 2h | ToolboxClient |
| 磁盘管理API封装 | P1 | 2h | ToolboxClient |

### 数据层任务
| 任务 | 优先级 | 预估工时 | 依赖 |
|------|--------|----------|------|
| ClamAV模型 | P0 | 2h | 无 |
| FTP模型 | P1 | 2h | 无 |
| Fail2ban模型 | P1 | 2h | 无 |
| Disk模型 | P1 | 2h | 无 |
| 工具状态模型 | P0 | 2h | 无 |

### UI层任务
| 任务 | 优先级 | 预估工时 | 依赖 |
|------|--------|----------|------|
| 工具箱入口页面 | P0 | 6h | 状态模型 |
| ClamAV管理页面 | P0 | 8h | ClamAV模型 |
| 扫描结果页面 | P0 | 4h | ClamAV模型 |
| FTP管理页面 | P1 | 6h | FTP模型 |
| Fail2ban管理页面 | P1 | 6h | Fail2ban模型 |
| 磁盘管理页面 | P1 | 4h | Disk模型 |

### 测试任务
| 任务 | 优先级 | 预估工时 | 依赖 |
|------|--------|----------|------|
| API客户端单元测试 | P0 | 4h | API层完成 |
| 模型单元测试 | P0 | 3h | 数据层完成 |
| Widget测试 | P1 | 4h | UI层完成 |
| 集成测试 | P2 | 4h | 全部完成 |

### 文档任务
| 任务 | 优先级 | 预估工时 | 依赖 |
|------|--------|----------|------|
| 工具使用指南 | P1 | 3h | UI层完成 |
| 配置说明文档 | P2 | 2h | API层完成 |

## 风险与应对策略

### 技术风险
| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|----------|
| 工具服务兼容性 | 中 | 中 | 检测服务版本，提供兼容提示 |
| 扫描任务耗时 | 低 | 高 | 提供后台执行和进度通知 |
| 磁盘操作风险 | 高 | 低 | 添加操作确认和回滚机制 |

### 业务风险
| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|----------|
| 误删感染文件 | 高 | 中 | 提供隔离和恢复机制 |
| FTP权限配置错误 | 中 | 中 | 提供配置验证和预览 |
| Fail2ban误封 | 中 | 中 | 提供白名单和解封功能 |

### 进度风险
| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|----------|
| 子模块数量多 | 中 | 高 | 分阶段实现，优先核心功能 |
| 测试覆盖不足 | 低 | 中 | 优先完成核心功能测试 |

## 验收标准

### 功能验收
- [ ] 工具箱入口正确显示各工具状态
- [ ] ClamAV扫描功能正常
- [ ] FTP账户管理正常
- [ ] Fail2ban配置正常
- [ ] 磁盘管理操作正常

### 质量验收
- [ ] 单元测试覆盖率≥70%
- [ ] 关键操作响应时间<200ms
- [ ] 无严重Bug
- [ ] 代码通过静态分析

### 文档验收
- [ ] 工具使用指南完整
- [ ] FAQ覆盖常见问题

---

**文档版本**: 1.0
**最后更新**: 2026-02-14
