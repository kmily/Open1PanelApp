# 工具箱模块FAQ

## 常见问题

### 1. ClamAV扫描很慢怎么办？

**可能原因**:
- 扫描目录文件过多
- 病毒库版本过旧
- 系统资源不足

**解决方案**:
1. 配置排除目录，跳过不需要扫描的路径
2. 更新病毒库到最新版本
3. 在系统空闲时执行扫描
4. 考虑增量扫描策略

### 2. 如何配置FTP用户访问权限？

**操作步骤**:
1. 进入工具箱 > FTP管理
2. 点击"添加用户"
3. 设置用户名和密码
4. 指定主目录
5. 配置权限（读/写/列表）
6. 保存配置

### 3. Fail2ban封禁了正常IP如何解封？

**解封方法**:
1. 进入工具箱 > Fail2ban管理
2. 切换到"封禁列表"标签
3. 找到需要解封的IP
4. 点击"解封"按钮
5. 可选：添加到白名单

### 4. 磁盘挂载失败怎么办？

**排查步骤**:
1. 检查磁盘是否已分区
2. 验证文件系统类型
3. 确认挂载点目录存在
4. 检查是否有其他进程占用
5. 查看系统日志获取详细错误

### 5. 病毒库更新失败怎么办？

**可能原因**:
- 网络连接问题
- 更新服务器不可达
- 磁盘空间不足

**解决方案**:
1. 检查网络连接
2. 尝试切换更新镜像源
3. 清理磁盘空间
4. 手动下载病毒库更新

### 6. 如何查看工具运行日志？

**查看方法**:
1. 进入工具箱页面
2. 点击对应工具卡片
3. 切换到"日志"标签
4. 选择时间范围
5. 支持关键词搜索

### 7. FTP连接被拒绝怎么办？

**排查步骤**:
1. 确认FTP服务已启动
2. 检查防火墙端口开放
3. 验证用户名密码正确
4. 检查用户权限配置
5. 查看FTP服务日志

### 8. 如何配置Fail2ban监控规则？

**配置步骤**:
1. 进入Fail2ban管理页面
2. 点击"添加监狱"
3. 选择监控服务类型（SSH/HTTP/FTP等）
4. 配置触发条件和封禁时间
5. 保存并启用规则

### 9. 磁盘空间不足如何清理？

**清理方法**:
1. 使用主机工具的"系统清理"功能
2. 清理软件包缓存
3. 清理日志文件
4. 清理临时文件
5. 卸载不需要的软件

### 10. 工具箱支持哪些系统工具？

**支持列表**:
- ClamAV：开源病毒扫描
- Fail2ban：入侵防御系统
- Pure-FTPd：FTP服务器
- 磁盘管理：分区和挂载
- 系统诊断：资源监控和清理

## 故障排查指南

### ClamAV问题
```
错误: 扫描任务启动失败
排查:
1. systemctl status clamav
2. 检查病毒库状态
3. 验证扫描路径权限
4. 查看clamav日志
```

### FTP问题
```
错误: FTP用户无法登录
排查:
1. systemctl status pure-ftpd
2. 检查用户配置
3. 验证目录权限
4. 查看FTP日志
```

### Fail2ban问题
```
错误: 规则不生效
排查:
1. systemctl status fail2ban
2. 检查监狱配置
3. 验证日志路径
4. fail2ban-client status
```

## 最佳实践

### 安全建议
- 定期更新病毒库
- 配置合理的Fail2ban规则
- 限制FTP用户权限
- 定期检查封禁列表

### 运维建议
- 在业务低峰执行扫描
- 定期清理系统缓存
- 监控磁盘使用率
- 保留操作日志

### 配置建议
- 排除不需要扫描的目录
- 设置合理的封禁时间
- 为FTP用户分配最小权限
- 定期备份配置文件

---

**文档版本**: 1.0
**最后更新**: 2026-02-14
